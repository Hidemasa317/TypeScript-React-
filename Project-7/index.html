<!doctype html>
<html lang="jp">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=, initial-scale=1.0" />
    <jptle>éƒµä¾¿ç•ªå·å¤‰æ›</title>
  </head>
  <style>
    /* #list {
      border: 1px solid black;
      padding: 8px;
      display: inline-block;
      list-style-position: inside;
    } */

    #container {
      width: 400px;
      margin: 0 auto;
      border: 1px solid rgb(240, 11, 11);
      padding: 16px;
    }

    .box {
      margin-top: 12px;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
  </style>
  <body>
    <div id="container">
      <h1>Address</h1>
      <label
        ><input id="zip" inputmode="numeric" placeholder="ä¾‹:0000000" />
        <button id="btn">ä½æ‰€å¤‰æ›ãƒœã‚¿ãƒ³</button> </label
      ><!-- éƒµä¾¿ç•ªå·å…¥åŠ›æ¬„ -->
      <br />

      <br />
      <div class="box">
        <div>ä½æ‰€: <span id="addr">-</span></div>
        <div id="msg"></div>
      </div>
    </div>

    <script>

      //ğŸ“¦idå–å¾—
      const zip = document.getElementById('zip');
      const btn = document.getElementById('btn');
      const addr = document.getElementById('addr');
      const msg = document.getElementById('msg');

      // ğŸ¤–å…¥åŠ›å€¤å—ã‘å–ã‚Šéƒ¨ã€è«–ç†æ¼”ç®—å­ã§nullãªã©ã®éš›ã«ç©ºæ–‡å­—ã«ã€‚
      // /\D/g, ''ã§ã‚ˆã‚Šæ•´å½¢ã—ã¦ã„ã‚‹ã€‚
      function normalizeZip(zipValue) {
        return (zipValue || '').replace(/\D/g, '');
      }

      //ğŸ¤–apié€šä¿¡éƒ¨
      async function apiConnect(zipcode) {
        const url = `https://zipcloud.ibsnet.co.jp/api/search?zipcode=${encodeURIComponent(zipcode)}`;
        const res = await fetch(url);
        const data = await res.json(); //âœ…Jsonã§å—ã‘å–ã‚‹ã€‚

        const result = data.results[0]; //âœ…é…åˆ—ã®ä¸€ä»¶ç›®å–å¾—
        return `${result.address1}${result.address2}${result.address3}`; //âœ…çµåˆã—ã¦è¿”ã™ã€‚
      }

      //ğŸ¤–ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²éƒ¨ã€ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã€
      btn.addEventListener('click', async () => {
        msg.textContent = '';
        addr.textContent = '-';

        const normalizedZip = normalizeZip(zip.value);
        if (normalizedZip.length !== 7) {
          msg.textContent = '7æ¡ã§å…¥åŠ›ï¼ˆãƒã‚¤ãƒ•ãƒ³å¯ï¼‰';
          return; //âœ…7æ–‡å­—ã§ãªã‘ã‚Œã°ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã€‚
        }

        const address = await apiConnect(normalizedZip);
        addr.textContent = address;
      });
    </script>
  </body>
</html>
